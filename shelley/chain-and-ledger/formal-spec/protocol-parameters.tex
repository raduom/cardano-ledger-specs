\section{Protocol Parameters}
\label{sec:protocol-parameters}

\begin{note}
  In this chapter, as well as the rest of this document, we no longer use the type $\Coin$.
  All the calulations are now defined in terms of the multicurrency type $\Value$.
  There are other places throughout the original Shelley ledger specification where
  $\Coin$ is used, but we did not inlcude the ones where the change is strictly a type
  change, with no change in logic. In these cases, assume the use of
  \[\mathsf{adaID} \mapsto (\mathsf{adaToken} \mapsto \var{q})\]
  instead of a coin value. The notation for various operations on this type
  is overloaded as scalar operations on the individual quantities $q$, so that
  we do not need to change the calculation notation.

  Things to consider: where might we need to check that some $\Value$ is strictly
  Ada? Other dangers?
\end{note}

For Plutus integration, we have added the following abstract types
(see Figure~\ref{fig:defs:protocol-parameters}):

\begin{itemize}
\item $\PlutusVer$: This represents the version number of the Plutus interpreter
\item $\CostMod$: These are coefficients used to convert \\
\texttt{resource primitives}~$\to \ExUnits$
\item $\Prices$: These are coefficients used to get the final price of script
execution, i.e. to perform the calculation \\
$\ExUnits \to \Value$.
\item $\ExUnits$ abstract units of resources for script execution
\end{itemize}

We also added several protocol parameters and accessor functions.


\begin{figure*}[htb]
  \emph{Abstract types}
  %
  \begin{equation*}
    \begin{array}{r@{~\in~}lr}
      \var{plv} & \PlutusVer & \text{current Plutus interpreter version}\\
      \var{costm} & \CostMod & \text{coefficients for cost model} \\
      \var{pr} & \Prices & \text{coefficients for ExUnits prices} \\
      \var{exunits} & \ExUnits & \text{abstract execution units} \\
    \end{array}
  \end{equation*}
  %
  \emph{Protocol Parameters}
  %
  \begin{equation*}
      \begin{array}{r@{~\in~}lr}
        \var{minPlutusVer} \mapsto \PlutusVer & \PParams & \text{oldest version ok for new outputs}\\
        \var{maxPlutusVer} \mapsto \PlutusVer & \PParams & \text{most recent supported Plutus interpreter version}\\
        \var{costm} \mapsto \CostMod & \PParams & \text{script exec cost model}\\
        \var{prices} \mapsto \Prices & \PParams & \text{coefficients for ExUnits prices} \\
        \var{maxTxExUnits} \mapsto \ExUnits & \PParams & \text{max total tx script execution resources}\\
        \var{maxBlockExUnits} \mapsto \ExUnits & \PParams & \text{max total block script execution resources}\\
      \end{array}
  \end{equation*}
  %
  \emph{Accessor Functions}
  %
  \begin{center}
  \fun{costm},~\fun{maxTxExUnits},~\fun{maxBlockExUnits},~\fun{prices},~\fun{minPlutusVer},
  ~\fun{maxPlutusVer}
  \end{center}
  %
  \emph{Selector Functions}
  %
  \begin{align*}
    & \fun{getPlutusPP} \in \PParams \to (\CostMod \times \ExUnits \times \ExUnits  \\
    & ~~ \times \Prices \times \PlutusVer \times \PlutusVer) \\
    & \fun{getPlutusPP}~\var{pp} = \\
    &~~ (\fun{costm}~\var{pp},~\fun{maxTxExUnits}~\var{pp},~\fun{maxBlockExUnits}~\var{pp}, \\
    &~~\fun{prices}~\var{pp},~\fun{minPlutusVer}~\var{pp},~\fun{maxPlutusVer}~\var{pp})
  \end{align*}
  %
  \caption{Definitions Used in Protocol Parameters}
  \label{fig:defs:protocol-parameters}
\end{figure*}

\clearpage
